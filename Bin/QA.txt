常见问题
1、如何判断PluginOK中间件是否已安装？
答：首先请确认自己配置的WS侦听端口是多少，单机版默认配置的是80端口，可自行在WrlConfig.json中修改。如果这些端口已被占用，中间件会自动把端口号+1后进行侦听。只要前端连接不上配置端口或自动+1的端口就可以认为还未安装，如果中间件被手工停止了服务，前端可通过自定义协议的URL进行启动，启动单机版：<a href="PluginOK://DeskRun">点击这里启动PluginOK单机版</a>
2、如何在前端实现PluginOK中间件升级？
答：中间件升级的请求JSON包类似这样：
{"req":"Wrl_Update","rid":1,"para":{"Name":"PluginOK升级包","Date":"2021-10-25","Desc":"1、切换文件签名证书、完成对Windows 11正式版兼容性测试；2、优化中间件和小程序退出机制，解决退出可能崩溃问题；3、优化刷新网页加载内嵌小程序性能，解决个别电脑启动内嵌小程序提示挂钩失败问题；4、完善VLC网页播放小程序和Office小程序...","DownAddr":"http://local.zorrosoft.com/Files/Update/Wrl_Update.pid","MD5":"C3EFF49B8325665FA0AF92ABC2E17D27","Version":"1.5.3.2","Size":14286848,"HideIns":0,"Cookie":"","Auth":"","TK":"5C781DD52C83EC1C516554799ED3DF91A6A7376B55ECCA52770BC2CBA64625F6E3A6663A3292FDD0D4551FED8CA9928DDB78100F0EC2CD50A773078BAB0D8191EAA53FA1632BE4C5593B6A44EB236E157E67440056ADC0FF4329F1EC80CE0A46E9A4CA8F335DD303F1E7510F469C72EDD81B826B599E08EA11650B698604FC634215F54CB26F8EBB1DC076BBAD04A1182FDCA0C2AC611CEC5B001331A498103696E8B593514D9BB8D8905C1BB62D399A5AB708AFC8E6174EB795512348E0AE15A566C969C31723E8EE605E6C793BF14F82B83BABFDFA176AFC0AE9801EAC033CAE72EAC9037482BD917085DDC41DB8BE4C7B335C1BC39E8F24256FEB8B40B102"}} 此JSON可通过SDK包中的打包工具生成，需要制定中间件哪些文件需要升级的目录，打包时需要注意开发版和正式版的打包工具配置文件是不一样的。关于如何打包请参考SDK包中的文档“PluginOK开发者手册.pdf”。中间件本身也提供了判断是否有新版的接口，请参考“TestWrl.txt”文档中的协议Wrl_Version说明。
3、如何实现PluginOK小程序安装和升级？
答：小程序安装或升级的协议请参考安装后的文件TestWrl.txt，每个小程序都可以通过SDK包中的打包工具生成安装包和升级包及对应的JSON请求，打包时同样需要注意开发版和正式版的打包工具配置文件是不一样的。然后把生成的安装或升级包文件放到您的WEB服务器上，确保无限制可通过HTTP协议下载，然后修改对应的JSON请求，写上DownAddr中实际的下载地址。然后在前端通过WS连接到PluginOK中间件上后执行，将自动启动小程序的安装和升级。
4、前端WS连接不上如何办？
答：前端WS连接不上时，首先需要确定中间件是否已经安装并启动，其次是查看中间件程序所在的data子目录下WrlService.txt运行日志，看实际侦听的IP和端口是多少。如果侦听端口和你连接指定的端口不匹配肯定是连接不上的，检查本机防火墙设置是否允许指定端口侦听，再检查是否本机启动了网络代理程序，如已启动先退出。另外需要确保中间件程序运行未被某些安全软件或杀毒软件拦截。PluginOK中间件及相关小程序，我们是进行了数字签名的，并提交到360做了白名单，如还遇到拦截，请手工添加整个目录程序进入其白名单程序库中再试。如果还不行，请重新安装操作系统或更换电脑进行体验。
5、PluginOK中间件重启后会自动运行吗？
答：中间件主程序默认是以系统服务方式启动运行，当操作系统启动后服务就会自动启动，所以当您登录到系统桌面时，前端是可以随时调用相关功能的。如因一些特殊情况不能以系统服务方式运行时需要修改配置文件中的参数NoService为1，这种运行模式下登录到系统桌面时，中间件才会启动运行，请确保自动运行的注册表项目不会被设置为禁止启动，或被安全或杀毒软件拦截。
6、PluginOK中间件安装和卸载时提示需要管理员权限确认如何处理？
答：这种一般是在Windows 7及以上版本系统中出现，在安装PluginOK中间件、非系统服务模式运行登录到桌面运行时可能会出现此提示，请选择是(Y)，否则会导致功能运行异常。
7、PluginOK中间件提示需要管理员权限确认时显示产品及公司名称如何修改？
答：需要用自己公司的签名证书重新签名，签名后的所有EXE及DLL文件需要重新提交到360做白名单，否则可能在运行时被360安全卫士等拦截。
8、PluginOK中间件是否完全开源？
答：本中间件是浏览器之外的一个通用外接系统，如果开源的话，会导致被人滥用从而威胁客户电脑的安全。所以我们只提供前端调用的代码完全开源，如您需要本中间件的源码用于安全审核或备案等，需另行协商。
9、PluginOK小程序是否完全开源？
答：PluginOK之上运行的小程序，如您需要，可以付费获得相关代码用于定制开发或安全备案。
10、PluginOK中间件是否收费？
答：本中间件及相关小程序如用于商业用途是收费的，具体收费政策请联系本公司客服获取最新报价信息。如用于公益用途，需相关公益机构出具相关证明。
11、PluginOK网络版和单机版有啥差异？
答：不管网络版还是单机版，都可以用于企业内网，无需外网可运行。网络版适用于项目，单机版适用于产品，并且单机版只提供给委托开发或自己开发的小程序(且不可开发与本公司有利益冲突的小程序)，本公司提供的各类小程序不适用于单机版的中间件授权，并且单机版报价会比网络版贵数倍。由于网络版有集中的授权管理端，所以在授权升级时非常方便，只需要更新服务端的授权文件即可完成所有终端的自动授权。
12、PluginOK中间件会对浏览器做改动吗？
答：不会对浏览器的任何文件做修改，也不会修改浏览器的主页等各种配置，技术实现也完全不依赖任何浏览器提供的开发接口，所以浏览器的升级也不会导致技术方案失效，可避免类似NPAPI插件升级到PPAPI后插件无法运行的问题。
13、PluginOK中间件如何保证安全？
答：PluginOK中间件及相关小程序，我们承诺不存在任何木马和病毒行为，如需安全审查或备案等，可付费获取相关源代码来验证。关于安全方面的详细信息，请参考SDK包中的文档“PluginOK中间件安全解决方案.pdf”。
14、如何关闭前端获取本机Mac地址功能？
答：请修改WrlConfig.json中Mac配置为0后保存。如是制作安装包，请修改程序目录的配置文件，如已安装实际生效的是Data子目录下的配置文件。除了Mac地址可唯一标识终端电脑外，中间件在协议Wrl_Version实现中会返回对应终端电脑的唯一序号，可以替代MAC地址用于识别终端电脑。
15、PluginOK中间件标准版和高级版有啥差异？
答：高级版显著的特征是支持内嵌网页小程序的运行，比如支持在网页中直接播放RTSP视频，直接打开doc、dwg等文档进行在线编辑、查看和审阅等。高级版一般是标准版报价的5倍，详细报价文档请微信联系客服获取。
16、PluginOK中间件可直接进行二次开发吗？
答：如您的需求不需要高级版的功能，可直接在http://local.zorrosoft.com 上下载SDK包和安装中间件后，可参考SDK包中的范例工程进行开发，小程序的配置可先直接沿用范例工程的PluginConfig.json，等需要实际打包安装发布时，再提交自己的小程序配置文件PluginConfig.json和公司相关信息申请对应的授权文件进行测试。如是需要高级版的功能，请先联系客服签订软件试用协议，测试验证高级版功能是否满足贵公司需求，如满足可先行购买一年的网络高级版授权进行二次开发，我们会提供Flash Player的内嵌网页小程序源代码工程(C++)以供参考。另外二次开发接口，请参考SDK包中的文档“PluginOK核心组件接口说明.xls”。
17、高级版启动小程序时的Url参数作用？
答：用于获取初始化显示内嵌网页小程序窗口的大小、位置和其它启动参数，一般这个参数指向您实际加载内嵌小程序的网页地址，如中间件获取不到url指向网页中的相关小程序参数，会导致实际显示的小程序位置与大小可能与需要的不符。
18、线上开发版和正式版有何差异？
答：线上开发版主要用于集成测试验证功能，PluginOK中间件会在启动时弹出定时消失的相关提示，部分请求可能随机性的调用失败，如需给客户现场部署使用，请联系客服购买正式授权，另外开发版授权一般是短期的，过期后自动转为试用版，更多功能会受到使用限制。不管是开发版还是正式版，网络版或单机版，前端集成时的调用接口都是一样的，所以在开发版上验证满足需求后，很容易的切换到正式版来使用。如果需要更多的安全特性，正式版中部分接口调用需要验证权限，详细请参考SDK包中文档“PluginOK中间件安全解决方案.pdf”的说明。
19、购买PluginOK中间件是否有正规发票？
答：PluginOK中间件及相关小程序，由成都佐罗软件有限公司研发并销售，可提供正规的增值税普通发票或增值税专用发票，税点是1%-3%，开票名称一般为本软件的产品名称，如有特殊要求请联系我们确认。
20、PluginOK中间件的兼容性如何？
答：对操作系统的兼容性： 1、全面兼容Windows XP、Vista、7、8、8.1、10等各版本32及64位桌面系统； 2、全面兼容Windows Server 2008、2012、2016、2019等各版本32及64位服务系统。对浏览器的兼容性：1、IE 8及以上版本； 2、Chrome 41及以上版本； 3、FireFox 52及以上版本； 4、Opera 36及以上版本； 5、Edge(Chrome内核) 80及以上版本； 6、360极速浏览器 9.5及以上版本； 7、360安全及企业安全浏览器； 8、QQ浏览器10及以上版本； 9、搜狗浏览器等。如有需要，可支持更多浏览器。
21、PluginOK中间件有Linux和Mac系统的版本吗？
答：目前暂时只支持Windows系统，如您有其它系统版本的需求，请微信联系我们客服沟通。
22、PluginOK中间件是否对其它软件或模块有依赖？
答：本软件发行版已经包含所有需要的DLL及EXE程序，无需如.NET或C++运行库等的额外支持，除非您的小程序需要依赖的相关支持库。具体到相关的小程序，可能需要安装对应的软件，比如需要打开在线编辑、查看或审核doc文档，需要安装微软Office软件或金山WPS办公软件。
23、PluginOK中间件及相关小程序是否可以代理销售？
答：我们欢迎各种互惠互利平等的合作，如您有客户资源或销售能力，可随时联系我们做进一步沟通，即使您不是公司，也可以成为我们的业务合伙人，只要有销售业绩就有相应的回报。
24、PluginOK中间件会一直持续更新并可免费获取升级版吗？
答：本中间件从2018年立项投入开发至今，我们一直在做持续的维护升级，2019年5月发布标准版，2020年7月发布高级版，随后发布了多个网页内嵌小程序及升级版，我们一直在努力，持续根据您的需求完善产品和提高稳定性及使用体验。本产品是成都佐罗软件有限公司最核心的拳头产品，会持续获得最大成都的资源进行升级和维护，只要购买了官方发布版本授权的客户，在授权期内，都可免费获得最新的升级程序包。
25、在一个WS连接中可以启动多个内嵌小程序吗？
答：每个WS连接需要确保是唯一的会话SID，同时一个WS连接里尽量确保只启动一个小程序，这样关闭连接也只关闭这个小程序。
26、安装时360安全卫士或其它杀毒软件弹出告警如何解决？
答：本软件每个正式版都会提交到360做程序白名单，如还遇到告警，请手工把程序目录所有EXE和DLL等添加到本地白名单中，其它安全类软件也是这样操作，本软件承诺不包含任何病毒及木马功能，所有DLL和EXE程序都有本公司的签名证书，请使用时确认签名证书是否被破坏。可把本软件在线提交到：https://www.virscan.org/ 进行扫描确认是否安全。
27、如何屏蔽中间件和播放小程序中的运行日志？
答：在前端请求WS连接的参数flag掩码中，去掉1即可，测试网页中默认设置的1，所以会输出比较多的日志信息，一旦系统运行稳定，可以屏蔽日志输出，提升系统运行速度。
28、如何在同一个网页中启动内嵌小程序的多个实例？
答：默认情况下，在不同的网页中可以分别启动一个内嵌小程序的实例。如您需要在同一个网页中启动播放小程序的多个实例，方法如下：A、WS连接中间件的参数flag值，在原来基础上+512，比如原来是1，那就写成513；B、请求启动播放小程序的Url指定的网页中，不要设置多路播放的源和显示位置信息，统一改为启动播放的JSON参数中指定；C、启动每一个播放小程序实例，都应该在单独的WS连接中进行，就是说不能放在同一个到中间件的WS连接中启动；D、启动多个实例时应该按先后顺序启动，不能同时启动，就是等一个启动后再启动下一个。